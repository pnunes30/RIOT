From 6e4b01854038fbd119f75c17ccb390e0b67769ad Mon Sep 17 00:00:00 2001
From: Philippe Nunes <philippe.nunes@cortus.com>
Date: Wed, 1 Aug 2018 12:56:09 +0200
Subject: [PATCH 1/8] Remove auto generated headers dependencies

To build only the D7A module, we need to remove in the D7A module and
in the framework headers all the includes of headers generated during the
framework build (platform_defs.h, hal_defs.h, framework_defs.h).
Alternatively, such auto generated headers should be included directly
in the framework implementation files.
---
 stack/framework/hal/chips/netdev_driver/inc/net/netopt.h | 2 --
 stack/framework/hal/inc/hwdebug.h                        | 1 -
 stack/framework/hal/inc/hwradio.h                        | 2 --
 stack/framework/inc/console.h                            | 1 -
 stack/framework/inc/dae.h                                | 1 -
 stack/framework/inc/debug.h                              | 1 -
 stack/framework/inc/fs.h                                 | 1 -
 stack/framework/inc/log.h                                | 1 -
 stack/framework/inc/shell.h                              | 2 --
 stack/framework/inc/timer.h                              | 2 +-
 stack/fs/d7ap_fs_data.c                                  | 1 -
 stack/modules/d7ap/d7ap_stack.c                          | 2 --
 stack/modules/d7ap/phy.h                                 | 2 --
 13 files changed, 1 insertion(+), 18 deletions(-)

diff --git a/stack/framework/hal/chips/netdev_driver/inc/net/netopt.h b/stack/framework/hal/chips/netdev_driver/inc/net/netopt.h
index d44ea6b..1866fe7 100644
--- a/stack/framework/hal/chips/netdev_driver/inc/net/netopt.h
+++ b/stack/framework/hal/chips/netdev_driver/inc/net/netopt.h
@@ -25,8 +25,6 @@
 #ifndef NET_NETOPT_H
 #define NET_NETOPT_H
 
-#include "platform_defs.h"
-
 #ifdef __cplusplus
 extern "C" {
 #endif
diff --git a/stack/framework/hal/inc/hwdebug.h b/stack/framework/hal/inc/hwdebug.h
index e37915c..351c39d 100644
--- a/stack/framework/hal/inc/hwdebug.h
+++ b/stack/framework/hal/inc/hwdebug.h
@@ -38,7 +38,6 @@
 
 #include "types.h"
 #include "link_c.h"
-#include "platform_defs.h"
 
 #if PLATFORM_NUM_DEBUGPINS > 0
     #define DEBUG_PIN_SET(pin) hw_debug_set(pin)
diff --git a/stack/framework/hal/inc/hwradio.h b/stack/framework/hal/inc/hwradio.h
index 175b310..0c79cfe 100644
--- a/stack/framework/hal/inc/hwradio.h
+++ b/stack/framework/hal/inc/hwradio.h
@@ -33,9 +33,7 @@
 #include "string.h"
 
 #include "link_c.h"
-#include "hal_defs.h"
 #include "timer.h"
-#include "platform_defs.h"
 
 #define HW_RSSI_INVALID 0x7FFF
 
diff --git a/stack/framework/inc/console.h b/stack/framework/inc/console.h
index 894a82f..9b39153 100644
--- a/stack/framework/inc/console.h
+++ b/stack/framework/inc/console.h
@@ -9,7 +9,6 @@
 
 #include "hwuart.h"
 
-#include "framework_defs.h"
 
 #ifdef FRAMEWORK_CONSOLE_ENABLED
 
diff --git a/stack/framework/inc/dae.h b/stack/framework/inc/dae.h
index 23c6078..9c28f20 100644
--- a/stack/framework/inc/dae.h
+++ b/stack/framework/inc/dae.h
@@ -25,7 +25,6 @@
 #define DAE_H_
 
 #include "stdint.h"
-#include "framework_defs.h"
 #include "stdbool.h"
 
 #define SUBPROFILES_NB	4
diff --git a/stack/framework/inc/debug.h b/stack/framework/inc/debug.h
index f89dfcd..09bce1a 100644
--- a/stack/framework/inc/debug.h
+++ b/stack/framework/inc/debug.h
@@ -27,7 +27,6 @@
 #ifndef __DEBUG_H_
 #define __DEBUG_H_
 
-#include "framework_defs.h"
 #include "assert.h" // start from assert.h which defines __ASSERT_FUNCT and then redefine assert
 #include "hwsystem.h"
 #include <stdio.h>
diff --git a/stack/framework/inc/fs.h b/stack/framework/inc/fs.h
index 954e74d..7b0a313 100644
--- a/stack/framework/inc/fs.h
+++ b/stack/framework/inc/fs.h
@@ -31,7 +31,6 @@
 #include <stdint.h>
 #include <stdbool.h>
 
-#include "framework_defs.h"
 #include "dae.h"
 #include "hwblockdevice.h"
     
diff --git a/stack/framework/inc/log.h b/stack/framework/inc/log.h
index 58afc20..d06ef39 100644
--- a/stack/framework/inc/log.h
+++ b/stack/framework/inc/log.h
@@ -38,7 +38,6 @@
 #define __LOG_H_
 
 #include "link_c.h"
-#include "framework_defs.h"
 #include "types.h"
 
 /*! \brief The source in the stack from which the log originates  */
diff --git a/stack/framework/inc/shell.h b/stack/framework/inc/shell.h
index 02c3320..6f6eba9 100644
--- a/stack/framework/inc/shell.h
+++ b/stack/framework/inc/shell.h
@@ -27,8 +27,6 @@
 #ifndef SHELL_H_
 #define SHELL_H_
 
-#include "framework_defs.h"
-
 #define SHELL_CMD_HEADER_SIZE 4
 
 #include "link_c.h"
diff --git a/stack/framework/inc/timer.h b/stack/framework/inc/timer.h
index e0791e5..e7def54 100644
--- a/stack/framework/inc/timer.h
+++ b/stack/framework/inc/timer.h
@@ -49,7 +49,6 @@
 #include "types.h"
 #include "scheduler.h"
 #include "hwtimer.h"
-#include "framework_defs.h"
 
 #ifndef FRAMEWORK_TIMER_RESOLUTION
 #define FRAMEWORK_TIMER_RESOLUTION 1MS
@@ -69,6 +68,7 @@ typedef struct
 //a bit of dirty macro evaluation to prepend HWTIMER_FREQ_ to the value of 'FRAMEWORK_TIMER_RESOLUTION'
 #define ___CONCAT2(a,b) a ## b
 #define ___CONCAT(a, b) ___CONCAT2(a,b)
+
 /*! \brief The frequency of the hardware timer used to power the framework timer
  *
  * This value can be configured by setting the 'FRAMEWORK_TIMER_RESOLUTION' CMake property
diff --git a/stack/fs/d7ap_fs_data.c b/stack/fs/d7ap_fs_data.c
index b2368d9..0d93ae3 100644
--- a/stack/fs/d7ap_fs_data.c
+++ b/stack/fs/d7ap_fs_data.c
@@ -20,7 +20,6 @@
  */
 
 #include "d7ap_fs.h"
-#include "platform_defs.h"
 #include "MODULE_D7AP_FS_defs.h"
 
 #ifdef MODULE_D7AP_FS_USE_DEFAULT_SYSTEMFILES
diff --git a/stack/modules/d7ap/d7ap_stack.c b/stack/modules/d7ap/d7ap_stack.c
index 033f608..ae8288e 100644
--- a/stack/modules/d7ap/d7ap_stack.c
+++ b/stack/modules/d7ap/d7ap_stack.c
@@ -19,8 +19,6 @@
  * \author philippe.nunes@cortus.com
  */
 
-#include "framework_defs.h"
-
 #include "bitmap.h"
 #include "errors.h"
 #include "debug.h"
diff --git a/stack/modules/d7ap/phy.h b/stack/modules/d7ap/phy.h
index c6746d2..c374974 100644
--- a/stack/modules/d7ap/phy.h
+++ b/stack/modules/d7ap/phy.h
@@ -32,10 +32,8 @@
 
 #include "link_c.h"
 #include "errors.h"
-#include "hal_defs.h"
 #include "timer.h"
 #include "hwradio.h"
-#include "platform_defs.h"
 
 #define HW_RSSI_INVALID 0x7FFF
 
-- 
2.7.4


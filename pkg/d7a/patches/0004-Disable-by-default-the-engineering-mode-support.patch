From aa583f7b8c4520ed5a7a1e6cf8a468945fb4d1da Mon Sep 17 00:00:00 2001
From: Philippe Nunes <philippe.nunes@cortus.com>
Date: Mon, 20 May 2019 14:34:21 +0200
Subject: [PATCH 4/8] Disable by default the engineering mode support

---
 stack/modules/d7ap/CMakeLists.txt     | 2 +-
 stack/modules/d7ap/engineering_mode.c | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/stack/modules/d7ap/CMakeLists.txt b/stack/modules/d7ap/CMakeLists.txt
index 3a8c3dd..cb64b1e 100644
--- a/stack/modules/d7ap/CMakeLists.txt
+++ b/stack/modules/d7ap/CMakeLists.txt
@@ -66,7 +66,7 @@ MODULE_HEADER_DEFINE(BOOL ${MODULE_PREFIX}_LOG_ENABLED)
 MODULE_OPTION(${MODULE_PREFIX}_PACKET_LOG_ENABLED "Enable logging for misc logs (not directly belonging to a specificlayer)" FALSE)
 MODULE_HEADER_DEFINE(BOOL ${MODULE_PREFIX}_PACKET_LOG_ENABLED)
 
-MODULE_OPTION(${MODULE_PREFIX}_EM_ENABLED "Enable engineering mode" TRUE)
+MODULE_OPTION(${MODULE_PREFIX}_EM_ENABLED "Enable engineering mode" FALSE)
 MODULE_HEADER_DEFINE(BOOL ${MODULE_PREFIX}_EM_ENABLED)
 
 MODULE_OPTION(${MODULE_PREFIX}_EM_LOG_ENABLED "Enable logging for the engineering mode" FALSE)
diff --git a/stack/modules/d7ap/engineering_mode.c b/stack/modules/d7ap/engineering_mode.c
index a024696..42f8844 100644
--- a/stack/modules/d7ap/engineering_mode.c
+++ b/stack/modules/d7ap/engineering_mode.c
@@ -15,6 +15,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
+#ifdef MODULE_D7AP_EM_ENABLED
 
 #include "engineering_mode.h"
 #include "MODULE_D7AP_defs.h"
@@ -271,3 +272,4 @@ error_t engineering_mode_stop()
 {
   fs_unregister_file_modified_callback(D7A_FILE_ENGINEERING_MODE_FILE_ID);
 }
+#endif
-- 
2.7.4

